<h1 id="title" class="title">Register</h1>
<div class="row">

  <div class="col-10">
    <nb-card>
      <nb-card-header>Registration Form</nb-card-header>
      <nb-card-body>
        <form #form="ngForm" [formGroup]="registerForm" (ngSubmit)="register()">
          <div class="form-group">
            <label for="firstName" ngxMarkAsterisk class="label">First Name</label>
            <input type="text"
                   formControlName="firstName"
                   nbInput
                   fullWidth
                   id="firstName"
                   placeholder="First Name">
            <ng-container *ngIf="registerFormControl.firstName.invalid && registerFormControl.firstName.touched || (form.submitted && registerFormControl.firstName.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.firstName.errors.required">
                First name is required!
              </p>
            </ng-container>
          </div>
          <div class="form-group">
            <label for="middleName" class="label">Middle Name</label>
            <input type="text" nbInput fullWidth formControlName="middleName" id="middleName" placeholder="Middle Name">
          </div>
          <div class="form-group">
            <label for="lastName" ngxMarkAsterisk class="label">Last Name</label>
            <input type="text" nbInput fullWidth formControlName="lastName" id="lastName" placeholder="Last Name">
            <ng-container *ngIf="registerFormControl.lastName.invalid && registerFormControl.lastName.touched || (form.submitted && registerFormControl.lastName.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.lastName.errors.required">
                Last name is required!
              </p>
            </ng-container>
          </div>
          <div class="form-group">
            <label for="email" ngxMarkAsterisk class="label">Email</label>
            <input type="email" nbInput fullWidth formControlName="email" id="email" placeholder="Email">
            <ng-container *ngIf="registerFormControl.email.invalid && registerFormControl.email.touched || (form.submitted && registerFormControl.email.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.email.errors.required">
                Email is required!
              </p>
              <p class="caption status-danger" *ngIf="registerFormControl.email.errors.email">
                Not a valid email!
              </p>
            </ng-container>
          </div>
          <div class="form-group">
            <label ngxMarkAsterisk class="label" for="password">Password</label>
            <input nbInput
                   type="password"
                   id="password"
                   formControlName="password"
                   name="password"
                   fullWidth>
            <ng-container *ngIf="registerFormControl.password.invalid && registerFormControl.password.touched || (form.submitted && registerFormControl.password.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.password.errors.required">
                Password is required!
              </p>
              <p class="caption status-danger" *ngIf="registerFormControl.password.errors.minlength || registerFormControl.password.errors.maxlength">
                Password should contain
                from 6
                to 20
                characters
              </p>
            </ng-container>
          </div>

          <div class="form-group">
            <label for="userType" ngxMarkAsterisk class="label">User Type</label>
            <nb-select id="userType"  formControlName="userType">
              <nb-option fullWidth *ngFor="let user of userType" [value]="user.key">
                {{ user.value | titlecase }}
              </nb-option>
            </nb-select>
            <ng-container *ngIf="registerFormControl.userType.invalid && registerFormControl.userType.touched || (form.submitted && registerFormControl.userType.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.userType.errors.required">
                User Type is required!
              </p>
            </ng-container>
          </div>
          <div class="form-group">
            <label ngxMarkAsterisk for="photo" class="label">Photo </label>
            <input type="file" nbInput fullWidth formControlName="photo" id="photo"  (change)="selectFile($event, 'photo')">
            <ng-container *ngIf="registerFormControl.photo.invalid && registerFormControl.photo.touched || (form.submitted && registerFormControl.photo.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.photo.errors.required">
                At least a passport sized photo is required!
              </p>
            </ng-container>
          </div>
<!--          Use email instead-->
          <div class="form-group">
            <label for="userName" class="label">User Name</label>
            <input type="text" formControlName="username" nbInput fullWidth id="userName" placeholder="User Name">
          </div>
          <div class="form-group">
            <label ngxMarkAsterisk class="label">Gender</label>
            <div>
              <nb-radio-group id="gender" fullWidth formControlName="gender" *ngFor="let value of gender">
                <nb-radio value="{{value.key}}">{{value.value}}</nb-radio>
              </nb-radio-group>
              <ng-container *ngIf="registerFormControl.gender.invalid && registerFormControl.gender.touched || (form.submitted && registerFormControl.gender.invalid )">
                <p class="caption status-danger" *ngIf="registerFormControl.gender.errors.required">
                  Gender is required!
                </p>
              </ng-container>
            </div>
          </div>
          <div class="form-group">
            <label for="occupation" class="label">Occupation</label>
            <input type="text" formControlName="occupation" nbInput fullWidth id="occupation" placeholder="Occupation">
          </div>
          <div class="form-group">
            <label for="telephone" class="label">Telephone Number</label>
            <input type="text" nbInput fullWidth formControlName="telephone" id="telephone" placeholder="+2547...">
            <ng-container *ngIf="registerFormControl.telephone.invalid && registerFormControl.telephone.touched || (form.submitted && registerFormControl.telephone.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.telephone.errors.pattern">
               Not a valid phone number!
              </p>
            </ng-container>
          </div>
          <div class="form-group">
            <label for="dateOfBirth" ngxMarkAsterisk class="label">Date of Birth</label>
            <input nbInput
                   id="dateOfBirth"
                   formControlName="dateOfBirth"
                   placeholder="Date of Birth"
                   fullWidth
                   [nbDatepicker]="formPicker">
            <nb-datepicker #formPicker></nb-datepicker>
            <ng-container *ngIf="registerFormControl.dateOfBirth.invalid && registerFormControl.dateOfBirth.touched || (form.submitted && registerFormControl.dateOfBirth.invalid )">
              <p class="caption status-danger" *ngIf="registerFormControl.dateOfBirth.errors.required">
                Date of Birth is required!
              </p>
            </ng-container>
          </div>
          <form #addressForm="ngForm" formGroupName="addressForm">
            <div class="form-group">
              <label for="address" class="label">Address</label>
              <textarea formControlName="address1" rows="5" nbInput fullWidth id="address" shape="semi-round"></textarea>
            </div>
            <div class="form-group">
              <label  ngxMarkAsterisk for="country" class="label">Country</label>
              <nb-select fullWidth id="country" formControlName="country">
                <nb-option  *ngFor="let country of countries" [value]="country.id">
                 <ng-container *ngIf="country.id === 110">
                   {{country.name}}
                 </ng-container>
                </nb-option>
              </nb-select>
              <ng-container *ngIf="addressFormControl.country.invalid && addressFormControl.country.touched || (addressForm.submitted && addressFormControl.country.invalid )">
                <p class="caption status-danger" *ngIf="registerFormControl.addressForm.get('country').errors.required">
                  Country is required!
                </p>
              </ng-container>
            </div>
            <div class="form-group" *ngIf="selectedCountry === 110">
              <label ngxMarkAsterisk for="county" class="label">County</label>
              <nb-select id="county" formControlName="county">
                <nb-option fullWidth *ngFor="let county of counties" [value]="county.id">
                  {{county.name}}
                </nb-option>
              </nb-select>
              <ng-container *ngIf="addressFormControl.county.invalid && addressFormControl.county.touched || (form.submitted && addressFormControl.county.invalid )">
                <p class="caption status-danger" *ngIf="addressFormControl.county.errors.required">
                  County is required!
                </p>
              </ng-container>
            </div>
            <div class="form-group">
              <label for="postalCode" class="label">Postal Code</label>
              <textarea formControlName="postalCode" rows="3"  shape="semi-round" nbInput fullWidth id="postalCode"></textarea>

            </div>
            <div class="form-group">
              <label for="zipCode" class="label">Zip Code</label>
              <input type="text" nbInput fullWidth id="zipCode">
            </div>
          </form>



          <div class="form-group">
            <nb-checkbox>Check me out</nb-checkbox>
          </div>
          <button type="submit"  nbButton status="danger">Submit</button>
        </form>
        <button class="btn-dark" (click)="populateWithDummy()" >Populate</button>
      </nb-card-body>
    </nb-card>
  </div>
</div>

